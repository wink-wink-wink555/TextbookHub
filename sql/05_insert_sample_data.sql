-- =============================================
-- 高校教材管理系统 - 示例数据插入脚本
-- =============================================

USE textbook_management;

-- =============================================
-- 1. 插入出版社数据
-- =============================================
INSERT INTO publisher (publisher_name, contact_person, contact_phone, address, email) VALUES
('高等教育出版社', '张三', '010-12345678', '北京市西城区德外大街4号', 'contact@hep.com.cn'),
('清华大学出版社', '李四', '010-23456789', '北京市海淀区清华大学校内', 'contact@tup.tsinghua.edu.cn'),
('人民邮电出版社', '王五', '010-34567890', '北京市丰台区成寿寺路11号', 'contact@ptpress.com.cn'),
('机械工业出版社', '赵六', '010-45678901', '北京市西城区百万庄大街22号', 'contact@cmpbook.com'),
('电子工业出版社', '孙七', '010-56789012', '北京市海淀区万寿路173信箱', 'contact@phei.com.cn'),
('科学出版社', '周八', '010-67890123', '北京市东城区东黄城根北街16号', 'contact@sciencep.com');

-- =============================================
-- 2. 插入教材类型数据
-- =============================================
INSERT INTO textbook_type (type_name, type_code, description) VALUES
('计算机科学与技术', 'CST', '包括程序设计、数据结构、算法等'),
('软件工程', 'SE', '包括软件开发、软件测试、项目管理等'),
('数据库原理', 'DB', '包括数据库设计、SQL、数据管理等'),
('网络工程', 'NE', '包括计算机网络、网络安全、通信原理等'),
('人工智能', 'AI', '包括机器学习、深度学习、模式识别等'),
('数学类', 'MATH', '包括高等数学、线性代数、概率论等'),
('英语类', 'ENG', '包括大学英语、专业英语等'),
('物理类', 'PHY', '包括大学物理、物理实验等');

-- =============================================
-- 3. 插入教材数据
-- =============================================
INSERT INTO textbook (isbn, textbook_name, author, publisher_id, type_id, edition, publication_date, price, description) VALUES
('ISBN9787040001', '数据库系统概论', '王珊、萨师煊', 1, 3, '第5版', '2020-09-01', 45.00, '数据库原理经典教材'),
('ISBN9787302001', 'Python程序设计', '董付国', 2, 1, '第2版', '2021-03-01', 52.00, 'Python入门与进阶教材'),
('ISBN9787115001', '计算机网络', '谢希仁', 3, 4, '第7版', '2020-01-01', 48.50, '计算机网络经典教材'),
('ISBN9787111001', '软件工程导论', '张海藩', 4, 2, '第6版', '2019-08-01', 42.00, '软件工程基础教材'),
('ISBN9787121001', '机器学习', '周志华', 5, 5, '第1版', '2021-06-01', 88.00, '机器学习权威教材'),
('ISBN9787030001', '高等数学（上册）', '同济大学数学系', 6, 6, '第7版', '2019-07-01', 38.00, '高等数学经典教材'),
('ISBN9787030002', '高等数学（下册）', '同济大学数学系', 6, 6, '第7版', '2019-07-01', 36.00, '高等数学经典教材'),
('ISBN9787040002', '线性代数', '同济大学数学系', 1, 6, '第6版', '2020-02-01', 32.00, '线性代数教材'),
('ISBN9787040003', '大学英语综合教程1', '李荫华', 1, 7, '第3版', '2020-09-01', 42.00, '大学英语教材'),
('ISBN9787040004', '大学物理', '张三慧', 1, 8, '第4版', '2019-09-01', 45.00, '大学物理教材'),
('ISBN9787302002', 'Java程序设计', '谭浩强', 2, 1, '第3版', '2021-01-01', 56.00, 'Java编程教材'),
('ISBN9787302003', 'C++程序设计', '谭浩强', 2, 1, '第4版', '2020-08-01', 54.00, 'C++编程教材'),
('ISBN9787115002', '操作系统原理', '汤小丹', 3, 1, '第4版', '2020-06-01', 48.00, '操作系统经典教材'),
('ISBN9787111002', '数据结构与算法', '严蔚敏', 4, 1, '第2版', '2019-09-01', 46.00, '数据结构教材'),
('ISBN9787121002', 'Web前端开发技术', '刘英男', 5, 2, '第1版', '2021-04-01', 52.00, 'Web开发教材');

-- =============================================
-- 4. 插入用户数据（密码为明文，实际应用中应加密）
-- =============================================
INSERT INTO user (username, password, real_name, role, department, email, phone) VALUES
('admin', 'admin123', '系统管理员', '管理员', '教务处', 'admin@university.edu.cn', '13800000000'),
('warehouse01', 'warehouse123', '张管理', '仓库管理员', '图书馆', 'warehouse@university.edu.cn', '13800000001'),
('teacher01', 'teacher123', '李老师', '教师', '计算机学院', 'teacher01@university.edu.cn', '13800000002'),
('teacher02', 'teacher123', '王老师', '教师', '软件学院', 'teacher02@university.edu.cn', '13800000003'),
('user01', 'user123', '普通用户1', '普通用户', '计算机学院', 'user01@university.edu.cn', '13800000004');

-- =============================================
-- 5. 插入订购数据
-- 注意：arrived_quantity 初始设为 0，由入库触发器自动累加！
-- 注意：order_status 初始不要设为"已到货"，由触发器根据到货情况自动更新！
-- =============================================
INSERT INTO purchase_order (order_no, textbook_id, order_quantity, order_date, expected_date, order_person, order_status, arrived_quantity) VALUES
('PO202401080001', 1, 100, '2024-01-08', '2024-01-20', 'warehouse01', '已审核', 0),
('PO202401080002', 2, 150, '2024-01-08', '2024-01-22', 'warehouse01', '已审核', 0),
('PO202401080003', 3, 120, '2024-01-09', '2024-01-25', 'warehouse01', '已订购', 0),
('PO202401080004', 5, 80, '2024-01-10', '2024-01-28', 'warehouse01', '已审核', 0),
('PO202401080005', 11, 200, '2024-01-10', '2024-01-30', 'warehouse01', '已审核', 0);

-- =============================================
-- 6. 插入入库数据
-- 注意：warehouse_person 使用用户名（username）而非真实姓名
-- 插入后触发器会自动：1.更新库存 2.更新订单的到货数量和状态
-- =============================================
INSERT INTO stock_in (stock_in_no, order_id, textbook_id, stock_in_quantity, stock_in_date, warehouse_person, quality_status, actual_quantity) VALUES
('SI202401100001', 1, 1, 100, '2024-01-20', 'warehouse01', '合格', 100),
('SI202401100002', 2, 2, 80, '2024-01-22', 'warehouse01', '合格', 80),
('SI202401100003', 5, 11, 200, '2024-01-25', 'warehouse01', '合格', 200);

-- =============================================
-- 执行完成后，检查结果：
-- =============================================
-- SELECT * FROM inventory;        -- 库存应该有数据了
-- SELECT * FROM stock_in;         -- 入库记录
-- SELECT * FROM purchase_order;   -- 订单的 arrived_quantity 和 order_status 应该被触发器更新

